<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>ğŸ“¸ ThÆ° viá»‡n Cloudinary</title>
  <style>
    body { font-family: Poppins, sans-serif; background:#f4f6f9; margin:0; }
    h1 { text-align:center; background:#4A90E2; color:white; padding:15px; margin:0; }
    .back-btn { display:block; margin:10px auto; text-align:center; text-decoration:none; color:white; background:#28a745; padding:8px 16px; border-radius:8px; width:120px; }
    .gallery-container {
      display:grid;
      grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
      gap:15px; padding:15px;
    }
    .card {
      position:relative; overflow:hidden;
      border-radius:10px; box-shadow:0 3px 8px rgba(0,0,0,0.2);
      transition:transform 0.2s;
      cursor:pointer;
    }
    .card:hover { transform:scale(1.05); }
    .card img, .card video { width:100%; height:160px; object-fit:cover; display:block; }
    .delete-btn {
      position:absolute; top:8px; right:8px; background:red;
      color:white; border:none; border-radius:50%; width:30px; height:30px;
      display:flex; align-items:center; justify-content:center;
      cursor:pointer; font-weight:bold;
    }
  </style>
</head>
<body>

<h1>ğŸ“¸ ThÆ° viá»‡n Cloudinary</h1>
<a href="/" class="back-btn">â¬…ï¸ Upload</a>

<div class="gallery-container">
  {% for res in resources %}
  <div class="card">
    {% if res.resource_type == 'video' %}
      <video muted loop playsinline><source src="{{ res.secure_url }}" type="video/mp4"></video>
    {% else %}
      <img src="{{ res.secure_url }}" alt="áº¢nh">
    {% endif %}
    <button class="delete-btn" onclick="deleteFile('{{ res.public_id }}')">ğŸ—‘ï¸</button>
  </div>
  {% endfor %}
</div>

<script>
async function deleteFile(publicId) {
  const password = prompt("ğŸ”’ Nháº­p máº­t kháº©u admin Ä‘á»ƒ xoÃ¡:");
  if (!password) return;
  const res = await fetch(`/delete/${publicId}?password=${password}`, { method: "DELETE" });
  const data = await res.json();
  if (data.success) {
    alert("ğŸ—‘ï¸ ÄÃ£ xoÃ¡!");
    location.reload();
  } else {
    alert("âŒ Lá»—i: " + (data.error || "KhÃ´ng xoÃ¡ Ä‘Æ°á»£c"));
  }
}
</script>
</body>
</html>
